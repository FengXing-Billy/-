<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="UTF-8">
    <title>登录页面</title>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="css/login.css">
    <script src="./js/jquery/jquery-3.5.1.min.js"></script>
    <script src="./tavel-font/iconfont.js"></script>
</head>
<body>

<!-- 大div放背景图片 -->
    <div class="bgp" id="app">

        <!-- 内部账号密码登录部分 -->
        <div class="login">
            <label>旅 游 网 登 录</label>
            <!-- 登录提交表单 -->
            <form action="#" method="POST">
                <input class="logininput1" type="text" v-model="user.uname" name="uname" placeholder="输入用户名"/><br/>

                <input class="logininput2" type="password" v-model="user.upassword" name="upassword" placeholder="输入密码"/><br/>
                <button @click="login" type="button">登 录</button>
                <p>没有账号密码?点击<a href="reg.html">注册账号</a>&nbsp/&nbsp<a href="user/userpage.html">跳过登录</a></p>
            </form>

            <!-- 其它登录方式 -->
            <div class="other">
                <svg class="icon" aria-hidden="true">
                    <use xlink:href="#icon-QQ"></use>
                </svg>
                <svg class="icon" aria-hidden="true">
                    <use xlink:href="#icon-weixin"></use>
                </svg>
                <svg class="icon" aria-hidden="true">
                    <use xlink:href="#icon-baidu"></use>
                </svg>
                <svg class="icon" aria-hidden="true">
                    <use xlink:href="#icon-shouji"></use>
                </svg>

            </div>
        </div>
    </div>

</body>
</html>
<script src="./js/vue.js"></script>
<script src="./js/axios.min.js"></script>

<script type="text/javascript">
    // jquer样式
    $(function(){

        // var inp1=$(':input').eq(0);
        // var inp2=$(':input').eq(1);
        var inp1=$('.logininput1');
        var inp2=$('.logininput2');

        $('.bgp').hide().fadeIn(1500);
        $('.login').hide().slideDown(1000);

        function showAndno(inp){
            inp.click(function(){
                inp.css("box-shadow","orange 0px 0px 10px ");
            });
            inp.blur(function(){
                inp.css("box-shadow","white 0px 0px");
            });
        }
        showAndno(inp1);
        showAndno(inp2);
    });
</script>

<script>
    axios.defaults.withCredentials = true;
    const app = new Vue({
        el:"#app",
        data:{
            user:{},
        },
        methods:{
            login(){//登录
                if(this.user.uname==null||this.user.upassword==null){
                    alert("用户名或密码为空");
                }else{
                    axios.post("http://localhost:8989/user/login",this.user).then((res)=>{
                        if(res.data.state){
                            if(res.data.msg=="管理员一"||res.data.msg=="管理员二"){
                                location.href='indexM.html?name='+res.data.msg;
                            }else{
                                localStorage.setItem("userid",res.data.userId);
                                location.href='user/userpage.html';
                            }
                        }else{
                            alert(res.data.msg);
                        }
                    });
                }
            }
        },
        created(){
            localStorage.removeItem("userid");
        }
    })

</script>